---
import { checkIsCSSLength, getSafeGutter, getSizeValue } from '@chisel-ui/core'
import './ColumnDrop.css'
import type { CSSLength, LayoutProps, SizesOptions } from '@chisel-ui/core'

export type Basis = CSSLength | number | SizesOptions

export interface ColumnsProps extends LayoutProps {
    basis?: Basis
    noStretchedColumns?: boolean
}

function getSafeBasis<T extends Record<string, unknown>>(theme: T, basis?: Basis) {
    if (typeof basis == "number") { return `${basis}px` }
    if (checkIsCSSLength(basis as string)) { return basis }
    return getSizeValue(theme, basis as string)
}

const { gutter = '0px', theme = {}, as: Tag = 'div', basis, noStretchedColumns  = false, style = '', ...props } = Astro.props as ColumnsProps

const maybeGutter = getSafeGutter(theme, gutter)
const safeBasis = getSafeBasis(theme, basis)
---

<Tag data-chisel-column-drop={noStretchedColumns ? "no-stretched-columns" : ""} style={`--gutter: ${maybeGutter}; --basis: ${safeBasis};${style}`} {...props}>
    <slot />
</Tag>

